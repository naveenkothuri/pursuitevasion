%{
Initial value of position = ip= 0;
Initial value of velocity1 = iv =150m/s;
variance of position error in output = Wp = (50m)^2
variance of position error in output = Wv = (15m/s)^2
Systems states are position and velocity1 with no process noise Why?
Because evader model is moving with constant velocity1. It is sensor
that is not sure of its measurements. 
sensor senses position and velocity1 

%System : 
         xe(t+1) = xe(t) + vx(t);
         v(t+1) = v(t); % where v = sqrt(vx^2+vy^2)
         ye(t+1)= ye(t) +vy(t)   % vx and vy as not part of states are
         considered as inputs
 %outputs 
 y(t) = [1 0 0;0 1 0;0 0 1]*(xe(t);v(t);ye(t))+[exe(t);ev(t);eye(t)]
%}
clear all
m=2;
Exx=[];
Eyy=[];
tx1=50;ty1=40; %Target
xp=50;yp=-30;  %Pursuer
vp1=4; 
T=400; %simulation steps T*delT will give total time
delT1=0.3;
ipx=120;ipy=50;
xe=ipx;ye=ipy;
hh=0;
iv=2; % This is mean of output.,Initial best estimate
sx=4; sy =4; %
sv=0.5;
sk=sv/vp1;
s.tx1=tx1;s.ty1=ty1;s.xe=ipx;s.ye=ipy;s.xp=xp;s.yp=yp;
xetru=ipx+3*sx;
yetru=ipy+3*sy;
ketru=(iv/vp1)+3*sk; %this is always fixed for Evader
Igactual=mapkal(tx1,ty1,xetru,yetru,xp,yp,ketru); % This is what initially pursued by evader.
Iginitial=mapkal(tx1,ty1,ipx,ipy,xp,yp,iv/vp1); % This is what initially pursued by pursuer.
s.x=[Iginitial(1);Iginitial(2);iv/vp1];  % these are the initial state estimate of the kalman system.
%s.u=0;
 %xpdeltainput=2*vp*delT*randn/3;ypdeltainput=2*vp*delT*randn/3;
     xpdeltainput=xp(end);ypdeltainput=yp(end);

 s.u=[xpdeltainput;ypdeltainput;xp(end);yp(end)];
%%
%%
syms a1 a2 a3 a4 a5 tx ty

yi=(((a2-a4*a5^2)/(1-a5^2))+sign(ty-((a2-a4*a5^2)/(1-a5^2)))*sqrt(((sqrt(((a1-a3)^2+(a2-a4)^2)*(a5^2/(1-a5^2)^2)))*((ty-((a2-a4*a5^2)/(1-a5^2)))/(tx-((a1-a3*a5^2)/(1-a5^2)))))^2/(1+((ty-((a2-a4*a5^2)/(1-a5^2)))/(tx-((a1-a3*a5^2)/(1-a5^2))))^2)));
xi=(((a1-a3*a5^2)/(1-a5^2))+sign(tx-((a1-a3*a5^2)/(1-a5^2)))*sqrt((sqrt(((a1-a3)^2+(a2-a4)^2)*(a5^2/(1-a5^2)^2)))^2/(1+((ty-((a2-a4*a5^2)/(1-a5^2)))/(tx-((a1-a3*a5^2)/(1-a5^2))))^2)));

C11=diff(xi,a3);
D11=diff(xi,a4);




C21=diff(yi,a3);
D21=diff(yi,a4);


syms xpdelta ypdelta xi yi vp delT

%xinext=xi+(C11*(xpdelta)+D11*(ypdelta));
%xinext=xi+(C11*(xpdelta)+D11*(ypdelta))-(C11*(a3+delT*vp*cos(atan((a4-yi)/(a3-xi))))+D11*(a4+delT*vp*sin(atan((a4-yi)/(a3-xi)))));
%yinext=yi+(C21*(xpdelta)+D21*(ypdelta))-(C21*(a3+delT*vp*cos(atan((a4-yi)/(a3-xi))))+D21*(a4+delT*vp*sin(atan((a4-yi)/(a3-xi)))));

xinext= xi - xpdelta*((sign(tx + (- a3*a5^2 + (-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))))/(a5^2 - 1))*((a5^2*(2*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - 2*a3))/((a5^2 - 1)^2*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)) + (2*a5^4*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2)/((a5^2 - 1)^3*((ty + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)^2*(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^3)))/(2*((a5^2*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2))/((a5^2 - 1)^2*((ty + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)))^(1/2)) - a5^2/(a5^2 - 1) + (2*a5^2*dirac(tx + (- a3*a5^2 + (-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))))/(a5^2 - 1))*((a5^2*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2))/((a5^2 - 1)^2*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)))^(1/2))/(a5^2 - 1)) + (a3 + (delT*vp)/((a4 - yi)^2/(a3 - xi)^2 + 1)^(1/2))*((sign(tx + (- a3*a5^2 + (-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))))/(a5^2 - 1))*((a5^2*(2*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - 2*a3))/((a5^2 - 1)^2*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)) + (2*a5^4*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2)/((a5^2 - 1)^3*((ty + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)^2*(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^3)))/(2*((a5^2*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2))/((a5^2 - 1)^2*((ty + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)))^(1/2)) - a5^2/(a5^2 - 1) + (2*a5^2*dirac(tx + (- a3*a5^2 + (-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))))/(a5^2 - 1))*((a5^2*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2))/((a5^2 - 1)^2*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)))^(1/2))/(a5^2 - 1)) - (ypdelta*sign(tx + (- a3*a5^2 + (-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))))/(a5^2 - 1))*((a5^2*(2*(((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - 2*a4))/((a5^2 - 1)^2*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)) - (2*a5^4*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1)))/((a5^2 - 1)^3*((ty + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)^2*(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2)))/(2*((a5^2*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2))/((a5^2 - 1)^2*((ty + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)))^(1/2)) + (sign(tx + (- a3*a5^2 + (-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))))/(a5^2 - 1))*((a5^2*(2*(((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - 2*a4))/((a5^2 - 1)^2*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)) - (2*a5^4*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1)))/((a5^2 - 1)^3*((ty + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)^2*(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2))*(a4 + (delT*vp*(a4 - yi))/((a3 - xi)*((a4 - yi)^2/(a3 - xi)^2 + 1)^(1/2))))/(2*((a5^2*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2))/((a5^2 - 1)^2*((ty + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)))^(1/2));
yinext= yi + (a4 + (delT*vp*(a4 - yi))/((a3 - xi)*((a4 - yi)^2/(a3 - xi)^2 + 1)^(1/2)))*((sign(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))*((2*a5^4*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1)))/((a5^2 - 1)^3*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2) - (2*a5^4*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^3)/((a5^2 - 1)^3*((ty + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)^2*(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^4) + (a5^2*(2*(((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - 2*a4)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2)/((a5^2 - 1)^2*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2)))/(2*((a5^2*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2)/((a5^2 - 1)^2*((ty + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2))^(1/2)) - a5^2/(a5^2 - 1) + (2*a5^2*dirac(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))*((a5^2*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2)/((a5^2 - 1)^2*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2))^(1/2))/(a5^2 - 1)) - ypdelta*((sign(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))*((2*a5^4*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1)))/((a5^2 - 1)^3*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2) - (2*a5^4*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^3)/((a5^2 - 1)^3*((ty + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)^2*(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^4) + (a5^2*(2*(((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - 2*a4)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2)/((a5^2 - 1)^2*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2)))/(2*((a5^2*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2)/((a5^2 - 1)^2*((ty + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2))^(1/2)) - a5^2/(a5^2 - 1) + (2*a5^2*dirac(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))*((a5^2*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2)/((a5^2 - 1)^2*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2))^(1/2))/(a5^2 - 1)) - (xpdelta*sign(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))*((2*a5^4*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^4)/((a5^2 - 1)^3*((ty + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)^2*(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^5) - (2*a5^4*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2)/((a5^2 - 1)^3*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^3) + (a5^2*(2*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - 2*a3)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2)/((a5^2 - 1)^2*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2)))/(2*((a5^2*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2)/((a5^2 - 1)^2*((ty + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2))^(1/2)) + (sign(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))*(a3 + (delT*vp)/((a4 - yi)^2/(a3 - xi)^2 + 1)^(1/2))*((2*a5^4*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^4)/((a5^2 - 1)^3*((ty + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)^2*(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^5) - (2*a5^4*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2)/((a5^2 - 1)^3*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^3) + (a5^2*(2*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - 2*a3)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2)/((a5^2 - 1)^2*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2)))/(2*((a5^2*(((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2)/((a5^2 - 1)^2*((ty + ((((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2))^(1/2));


dxindxi=diff(xinext,xi);
dxindyi=diff(xinext,yi);
 dxindxpd=diff(xinext,xpdelta);
 dxindypd=diff(xinext,ypdelta);

 dxindxp=diff(xinext,a3);
 dxindyp=diff(xinext,a4);

dxindke=diff(xinext,a5);


%yinext=yi+(C21*(xpdelta)+D21*(ypdelta));
%yinext=yi + (a4 + (6*(a4 - yi))/(5*(a3 - xi)*((a4 - yi)^2/(a3 - xi)^2 + 1)^(1/2)))*((sign(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))*((2*a5^4*(((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1)))/((a5^2 - 1)^3*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2) - (2*a5^4*(((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^3)/((a5^2 - 1)^3*((ty + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)^2*(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^4) + (a5^2*(2*(((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - 2*a4)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2)/((a5^2 - 1)^2*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2)))/(2*((a5^2*(((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2)/((a5^2 - 1)^2*((ty + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2))^(1/2)) - a5^2/(a5^2 - 1) + (2*a5^2*dirac(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))*((a5^2*(((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2)/((a5^2 - 1)^2*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2))^(1/2))/(a5^2 - 1)) - ypdelta*((sign(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))*((2*a5^4*(((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1)))/((a5^2 - 1)^3*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2) - (2*a5^4*(((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^3)/((a5^2 - 1)^3*((ty + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)^2*(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^4) + (a5^2*(2*(((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - 2*a4)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2)/((a5^2 - 1)^2*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2)))/(2*((a5^2*(((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2)/((a5^2 - 1)^2*((ty + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2))^(1/2)) - a5^2/(a5^2 - 1) + (2*a5^2*dirac(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))*((a5^2*(((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2)/((a5^2 - 1)^2*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2))^(1/2))/(a5^2 - 1)) + (sign(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))*(a3 + 6/(5*((a4 - yi)^2/(a3 - xi)^2 + 1)^(1/2)))*((2*a5^4*(((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^4)/((a5^2 - 1)^3*((ty + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)^2*(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^5) - (2*a5^4*(((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2)/((a5^2 - 1)^3*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^3) + (a5^2*(2*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - 2*a3)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2)/((a5^2 - 1)^2*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2)))/(2*((a5^2*(((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2)/((a5^2 - 1)^2*((ty + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2))^(1/2)) - (xpdelta*sign(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))*((2*a5^4*(((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^4)/((a5^2 - 1)^3*((ty + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)^2*(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^5) - (2*a5^4*(((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2)/((a5^2 - 1)^3*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^3) + (a5^2*(2*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - 2*a3)*(ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2)/((a5^2 - 1)^2*((ty + (- a4*a5^2 + (((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2))/(a5^2 - 1))^2/(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2)))/(2*((a5^2*(((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3)^2 + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4)^2)*(ty + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2)/((a5^2 - 1)^2*((ty + ((((ty-yi)/(tx-xi))*(-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2) - a4*a5^2)/(a5^2 - 1))^2/(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2 + 1)*(tx + ((-(-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-1*((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-(double(sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2)))) - a3*a5^2)/(a5^2 - 1))^2))^(1/2));

dyindxi=diff(yinext,xi);
dyindyi=diff(yinext,yi);
 dyindxpd=diff(yinext,xpdelta);
 dyindypd=diff(yinext,ypdelta);

 dyindxp=diff(yinext,a3);
 dyindyp=diff(yinext,a4);

dyindke=diff(yinext,a5);

Evaderx = (-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))));
Evadery = (((ty-yi)/(tx-xi))*(-(-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))+sign(xi-tx)*sqrt((-((1+((ty-yi)/(tx-xi))^2)*xi+((ty-yi)/(tx-xi))*a5^2*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3)))/(1+((ty-yi)/(tx-xi))^2))^2-(-((sqrt(a5^2*((a3-xi)^2+(a4-yi)^2)))^2-((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))^2*a5^4-2*((ty-yi)/(tx-xi))*xi*((yi-a4)-((ty-yi)/(tx-xi))*(xi-a3))*a5^2-xi^2*(1+((ty-yi)/(tx-xi))^2))/(1+((ty-yi)/(tx-xi))^2))))+((yi)-((ty-yi)/(tx-xi))*(xi))*(1-a5^2)+(a4-((ty-yi)/(tx-xi))*a3)*a5^2);

dexdxi =diff(Evaderx,xi);
dexdyi =diff(Evaderx,yi);
dexdke =diff(Evaderx,a5);

deydxi =diff(Evadery,xi);
deydyi =diff(Evadery,yi);
deydke =diff(Evadery,a5);


%%
s.R=[(sx)^2 0 0;0 (sy)^2 0;0 0 (sk)^2];
%{
s.P=[(sx)^2 0 0;0 (sy)^2 0;0 0 (sk)^2];
%}

%Later, in each step it gets updated
%s.Q =[(L.sigma(1))^2 0 0;0 (L.sigma(2))^2 0; 0 0 0]; % We have in our system process noise, don't forget to update this.
s.Q=s.R;
s.F=[
   (vp1*delT1/3)^2 0 0 0;
   0 (vp1*delT1/3)^2 0 0 
   0 0 0 0;
   0 0 0 0];
%
%Our actual system is true interception point which is pursued by the
%evader. At t=0, both get initial readings, at t=1, I am modelling actual
%interception point change as the present interception point + change
%occured in pursuer's interception point 
Igxe=Igactual(1);
Igye=Igactual(2);
 tru=[Igxe;Igye;ketru]; % true initial states
 for t=1:T
  if(hh~=1)
     E=mapupdatedkal(tru(end-2),tru(end-1),xetru(end),yetru(end),ketru(end)*vp1,delT1);
  else
      E=mapupdatedkal(tx1,ty1,xetru(end),yetru(end),ketru(end)*vp1,delT1);
  end
         % Ep=mapupdatedkal(s(end).x(1),s(end).x(2),s(end).xe,s(end).ye,s(end).x(3)*vp,delT);
          

     Pursuer=mapupdatedkal(s(end).x(1),s(end).x(2),xp(end),yp(end),vp1,delT1); % for next step pursuer
     %Ep=inverseevader(tx1,ty1,s(end).x(1),s(end).x(2),Pursuer(1),Pursuer(2),s(end).x(3)); %Using the next step pursuer and present interceptionpoint, we are finding next step evader.
  
%%
B11=double(subs(dxindxpd,{vp,delT,tx,ty,a3,a4,a5,xpdelta,ypdelta,xi,yi},{vp1,delT1,tx1,ty1,xp(end),yp(end),s(end).x(3),xpdeltainput,ypdeltainput,s(end).x(1),s(end).x(2)}));
B12=double(subs(dxindypd,{vp,delT,tx,ty,a3,a4,a5,xpdelta,ypdelta,xi,yi},{vp1,delT1,tx1,ty1,xp(end),yp(end),s(end).x(3),xpdeltainput,ypdeltainput,s(end).x(1),s(end).x(2)}));
B13=double(subs(dxindxp,{vp,delT,tx,ty,a3,a4,a5,xpdelta,ypdelta,xi,yi},{vp1,delT1,tx1,ty1,xp(end),yp(end),s(end).x(3),xpdeltainput,ypdeltainput,s(end).x(1),s(end).x(2)}));
B14=double(subs(dxindyp,{vp,delT,tx,ty,a3,a4,a5,xpdelta,ypdelta,xi,yi},{vp1,delT1,tx1,ty1,xp(end),yp(end),s(end).x(3),xpdeltainput,ypdeltainput,s(end).x(1),s(end).x(2)}));

A11=double(subs(dxindxi,{vp,delT,tx,ty,a3,a4,a5,xpdelta,ypdelta,xi,yi},{vp1,delT1,tx1,ty1,xp(end),yp(end),s(end).x(3),xpdeltainput,ypdeltainput,s(end).x(1),s(end).x(2)}));

A12=double(subs(dxindyi,{vp,delT,tx,ty,a3,a4,a5,xpdelta,ypdelta,xi,yi},{vp1,delT1,tx1,ty1,xp(end),yp(end),s(end).x(3),xpdeltainput,ypdeltainput,s(end).x(1),s(end).x(2)}));

A13=double(subs(dxindke,{vp,delT,tx,ty,a3,a4,a5,xpdelta,ypdelta,xi,yi},{vp1,delT1,tx1,ty1,xp(end),yp(end),s(end).x(3),xpdeltainput,ypdeltainput,s(end).x(1),s(end).x(2)}));

B21=double(subs(dyindxpd,{vp,delT,tx,ty,a3,a4,a5,xpdelta,ypdelta,xi,yi},{vp1,delT1,tx1,ty1,xp(end),yp(end),s(end).x(3),xpdeltainput,ypdeltainput,s(end).x(1),s(end).x(2)}));
B22=double(subs(dyindypd,{vp,delT,tx,ty,a3,a4,a5,xpdelta,ypdelta,xi,yi},{vp1,delT1,tx1,ty1,xp(end),yp(end),s(end).x(3),xpdeltainput,ypdeltainput,s(end).x(1),s(end).x(2)}));
B23=double(subs(dyindxp,{vp,delT,tx,ty,a3,a4,a5,xpdelta,ypdelta,xi,yi},{vp1,delT1,tx1,ty1,xp(end),yp(end),s(end).x(3),xpdeltainput,ypdeltainput,s(end).x(1),s(end).x(2)}));
B24=double(subs(dyindyp,{vp,delT,tx,ty,a3,a4,a5,xpdelta,ypdelta,xi,yi},{vp1,delT1,tx1,ty1,xp(end),yp(end),s(end).x(3),xpdeltainput,ypdeltainput,s(end).x(1),s(end).x(2)}));
A23=double(subs(dyindke,{vp,delT,tx,ty,a3,a4,a5,xpdelta,ypdelta,xi,yi},{vp1,delT1,tx1,ty1,xp(end),yp(end),s(end).x(3),xpdeltainput,ypdeltainput,s(end).x(1),s(end).x(2)}));
A21=double(subs(dyindxi,{vp,delT,tx,ty,a3,a4,a5,xpdelta,ypdelta,xi,yi},{vp1,delT1,tx1,ty1,xp(end),yp(end),s(end).x(3),xpdeltainput,ypdeltainput,s(end).x(1),s(end).x(2)}));
A22=double(subs(dyindyi,{vp,delT,tx,ty,a3,a4,a5,xpdelta,ypdelta,xi,yi},{vp1,delT1,tx1,ty1,xp(end),yp(end),s(end).x(3),xpdeltainput,ypdeltainput,s(end).x(1),s(end).x(2)}));

c11=double(subs(dexdxi,{tx,ty,a3,a4,a5,xi,yi},{tx1,ty1,xp(end),yp(end),s(end).x(3),s(end).x(1),s(end).x(2)}));
   c12=double(subs(dexdyi,{tx,ty,a3,a4,a5,xi,yi},{tx1,ty1,xp(end),yp(end),s(end).x(3),s(end).x(1),s(end).x(2)}));
   c13=double(subs(dexdke,{tx,ty,a3,a4,a5,xi,yi},{tx1,ty1,xp(end),yp(end),s(end).x(3),s(end).x(1),s(end).x(2)}));
   c21=double(subs(deydxi,{tx,ty,a3,a4,a5,xi,yi},{tx1,ty1,xp(end),yp(end),s(end).x(3),s(end).x(1),s(end).x(2)}));
   c22=double(subs(deydyi,{tx,ty,a3,a4,a5,xi,yi},{tx1,ty1,xp(end),yp(end),s(end).x(3),s(end).x(1),s(end).x(2)}));
   c23=double(subs(deydke,{tx,ty,a3,a4,a5,xi,yi},{tx1,ty1,xp(end),yp(end),s(end).x(3),s(end).x(1),s(end).x(2)}));
s(end).H=[c11 c12 c13;c21 c22 c23;0 0 1];
if(t==1)
s.P=inv(s.H)*s.R*inv(s.H');
covIx=s(end).P(1,1);
covIy=s(end).P(2,2);
covv=s(end).P(3,3);
end

%%

s(end).A=[A11 A12 A13;A21 A22 A23;0 0 1];
s(end).B=[B11 B12 B13 B14 ;B21 B22 B23 B24;0 0 0 0]; 

%s(end).Q =[(L(end).sigma(1))^2 0 0;0 (L(end).sigma(2))^2 0; 0 0 0];
    Em=inverseevader(tx1,ty1,tru(end-2),tru(end-1),xp(end),yp(end),tru(end)); %Using the next step pursuer and present interceptionpoint, we are finding next step evader.
    actm=[Em(1);Em(2);tru(end)]+sqrt(s(end).R)*randn(3,1);
    expm = inverseevader(tx1,ty1,s(end).x(1),s(end).x(2),xp(end),yp(end),s(end).x(3));
     s(end).expectedmeasurement = [expm(1);expm(2);s(end).x(3)];
    %s(end).z = (s(end).H)*tru(end-2:end,1) + sqrt(s(end).R)*randn(3,1); % Here we are using tru(end-3:end-2) because present states are stored there
     s(end).z=actm;
   %create a measurement. ( This is actual measurement)
   %Note that when t=0, s.x is still the initial value. This along with
   %actual output is given to kalman filter.
   %{
   xetru(end+1)=E(1);yetru(end+1)=E(2);
     xp(end+1)=Pursuer(1);yp(end+1)=Pursuer(2);
     xe(end+1)=Ep(1);ye(end+1)=Ep(2);
   s(end).xp=xp(end);
      s(end).yp=yp(end);
      s(end).xe=xp(end);
   s(end).xe=xp(end);
   %}
   s(end).xin=double(subs(xinext,{vp,delT,tx,ty,a3,a4,a5,xpdelta,ypdelta,xi,yi},{vp1,delT1,tx1,ty1,xp(end),yp(end),s(end).x(3),xpdeltainput,ypdeltainput,s(end).x(1),s(end).x(2)}));
   s(end).yin=double(subs(yinext,{vp,delT,tx,ty,a3,a4,a5,xpdelta,ypdelta,xi,yi},{vp1,delT1,tx1,ty1,xp(end),yp(end),s(end).x(3),xpdeltainput,ypdeltainput,s(end).x(1),s(end).x(2)}));
   s(end).kin=s(end).x(3);


   s(end+1)=kalmanfforoutputevader(s(end)); % perform a Kalman filter iteration
Ep=inverseevader(tx1,ty1,s(end).x(1),s(end).x(2),Pursuer(1),Pursuer(2),s(end).x(3)); %Using the next step pursuer and present interceptionpoint, we are finding next step evader.
Exx(end+1)=double(subs(Evaderx,{tx,ty,a3,a4,a5,xi,yi},{tx1,ty1,xp(end),yp(end),s(end).x(3),s(end).x(1),s(end).x(2)}));
Eyy(end+1)=double(subs(Evadery,{tx,ty,a3,a4,a5,xi,yi},{tx1,ty1,xp(end),yp(end),s(end).x(3),s(end).x(1),s(end).x(2)}));
   Exx(end);
   Eyy(end);
   xetru(end+1)=E(1);yetru(end+1)=E(2);
     xp(end+1)=Pursuer(1);yp(end+1)=Pursuer(2);
     xe(end+1)=Ep(1);ye(end+1)=Ep(2);
      %xpdeltainput=2*vp*delT*randn/3;ypdeltainput=2*vp*delT*randn/3;
     xpdeltainput=2*xp(end)-xp(end-1);ypdeltainput=2*yp(end)-yp(end-1);
     tru(end+1:end+2,1) =mapkal(tx1,ty1,xetru(end),yetru(end),xp(end),yp(end),ketru(end));% These are actual states. We induce noise here to get actual output. 
    tru(end+1,1)=tru(end-2);
   s(end).u=[xpdeltainput;ypdeltainput;xp(end);yp(end)];
   
   %Now in the second structure, s.x  is updated with the best prediction
  % i.e., x(1) given one measurement
   %given one measurement. This is again used in the next iteration to
   %generate x(2) given one measurement from model. That is used along
   %with second measurement to generate x(2) given two measurements and
  % the outupt of kalman filter is x(2) given two measurements.
   
   covIx(end+1)=s(end).P(1,1);  %just to plot covariances
   covIy(end+1)=s(end).P(2,2);
   covv(end+1)=s(end).P(3,3);
   %}
     X4 = [xp(end),yp(end);xetru(end),yetru(end)];
        d4 = pdist(X4,'euclidean');
                X3 = [xetru(end),yetru(end);tru(end-5),tru(end-4)];
        d3 = pdist(X3,'euclidean');
        X2 = [tru(end-2),tru(end-1);tx1,ty1];
        d2 = pdist(X2,'euclidean');
     if(d4<3)
        disp('Pursuer won');
        t
        break;                        
    elseif(d3<1)
        hh=1;
        if(d2<1)
        disp('Evader won');
        t
        break;  
        end
    end
 
 end
 hold on
 grid on
 for i =1:t
 posmIx(:,i)= s(i).z(1);
 posmIy(:,i)= s(i).z(2);
 posmv(:,i)=s(i).z(3)*vp1;
 end
 for i=1:t-1
 posteriorposIx(:,i)= s(i+1).x(1);
 posteriorposIy(:,i)= s(i+1).x(2);
 posteriorvec(:,i)=s(i+1).x(3)*vp1;

 end
 for i =1:t
     Igactualx(i)=tru(1+3*(i-1));
     Igactualy(i)=tru(2+3*(i-1));
     vtru(i)=tru(3+3*(i-1))*vp1;
     T(i)=i;
 end
 %
 xc=(xetru(1)-((xp(1))*((ketru)^2)))/(1-(ketru)^2);
yc=(yetru(1)-((yp(1))*((ketru)^2)))/(1-(ketru)^2);
r=double(sqrt(xc^2+yc^2-((xetru(1)^2+yetru(1)^2)/(1-(ketru)^2))+((ketru)^2*(xp(1)^2+yp(1)^2))/(1-(ketru)^2)));
h=circle(xc,yc,r);
 hold on
  plot(xetru,yetru,'r.');
  plot(tx1,ty1,'r*');
  plot(xp,yp,'b.');
  plot(xe,ye,'g.')
  %plot(Exx,Eyy,'r*')
   plot(posmIx,posmIy,'bo');
  plot(tru(end-2),tru(end-1),'ro');
 %{
 figure
 plot(posmIx,posmIy,'ro');
 hold on
 plot(posteriorposIx,posteriorposIy,'b*')
  hold off
  %}
  figure
  plot(T,vtru)
  hold on
  plot(T(2:end),posteriorvec)
i=1:t+1;
  figure
  subplot(3,1,1)
  plot(i,covIx)
  subplot(3,1,2)
  plot(i,covIy)
  subplot(3,1,3)
  plot(i,covv)
  figure  
  subplot(3,1,1)
    plot(Igactualx(2:end)-posteriorposIx)
  subplot(3,1,2)
    plot(Igactualy(2:end)-posteriorposIy)
    subplot(3,1,3)
    plot(vtru(2:end)-posteriorvec)
  Distancmovedbyevader=sqrt((xetru(1)-xetru(end))^2+(yetru(1)-yetru(end))^2)
  Timetakenbyevader=Distancmovedbyevader/vtru(end)
  Distancmovedbypursuer=sqrt((xp(1)-xp(end))^2+(yp(1)-yp(end))^2)
  Timetakenbypursuer=Distancmovedbypursuer/vp1
  Initialinterceptionpoint=[Igxe;Igye]
  Finalinterceptionpoint=[tru(end-2);tru(end-1)]

%{
  load('A.mat')
load('B.mat')
xp1=[A.xp B.xp];
xe1=[A.xe B.xe];
ye1=[A.ye B.ye];
yp1=[A.yp B.yp];
Ix1=[A.Ix B.Ix];
Iy1=[A.Iy B.Iy];
Iacty1=[A.Iacty B.Iacty];
Iactx1=[A.Iactx B.Iactx];
plot(xe1,ye1)
hold on
plot(xp1,yp1)
plot(Ix1,Iy1,'*')
plot(Iactx1,Iacty1,'*')
  
  %}